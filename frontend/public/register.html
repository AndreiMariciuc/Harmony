<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Register</title>
		<link rel="stylesheet" href="css/login-register.css" />
	</head>
	<body>
		<div class="login-div">
			<div class="title">Register</div>
			<div class="sub-title">Please complete the following</div>
			<div class="fields">
				<div class="username">
					<input
						type="username"
						id="username-input"
						class="user-input"
						placeholder="Username"
					/>
				</div>
				<div class="password">
					<input
						type="password"
						id="password-input"
						class="pass-input"
						placeholder="Password"
					/>
				</div>
				<div class="email">
					<input
						type="text"
						id="email-input"
						class="e-input"
						placeholder="Email"
					/>
				</div>
			</div>
			<button id="sign-in-btn">Register</button>
			<br /><br />
			<button id="login-btn">Go to login</button>
			<br /><br /><br />
		</div>

		<!--		<form method="POST" id="registerForm">-->
		<!--			<label for="username">Username: </label>-->
		<!--			<input type="text" id="username" /><br />-->
		<!--			<label for="password">Password: </label>-->
		<!--			<input type="password" id="password" /><br />-->
		<!--			&lt;!&ndash;  <label for="confirm">Confirm password: </label>&ndash;&gt;-->
		<!--			&lt;!&ndash;  <input type="password" name="confirm"/><br/>&ndash;&gt;-->
		<!--			<label for="email">Email: </label>-->
		<!--			<input type="email" id="email" /><br />-->
		<!--			&lt;!&ndash;  <input type="submit" value="Register"/>&ndash;&gt;-->
		<!--			<button id="register-btn">Register</button>-->
		<!--			<button id="login-btn">Login</button>-->
		<!--		</form>-->

		<div id="error"></div>

		<script>
			const submitForm = async e => {
				e?.preventDefault();

				const username = document.getElementById('username-input').value;
				const password = document.getElementById('password-input').value;
				const email = document.getElementById('email-input').value;

				const user = {
					username: username,
					password: password,
					email: email,
				};

				fetch('/register', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
					},
					body: JSON.stringify(user),
				})
					.then(response => response.json())
					.then(accountDto => {
						if (accountDto.err == null) {
							// window.location = '/sign-in';
							window.location.reload(true);
						} else {
							document.getElementById('error').innerHTML = accountDto.message;
						}
					});
			};

			const btn = document.querySelector('#sign-in-btn');
			btn.addEventListener('click', submitForm);

			const registerBtn = document.getElementById('login-btn');
			registerBtn.addEventListener('click', e => {
				e.preventDefault();

				window.location.href = '/';
			});

			document.addEventListener('keydown', e => {
				if (e.key === 'Enter') {
					submitForm();
				}
			});
		</script>
	</body>
</html>
