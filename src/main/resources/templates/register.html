<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>Register</h1>
<form method="POST" id="registerForm">
    <label for="username">Username: </label>
    <input type="text" id="username"/><br/>
    <label for="password">Password: </label>
    <input type="password" id="password"/><br/>
    <!--  <label for="confirm">Confirm password: </label>-->
    <!--  <input type="password" name="confirm"/><br/>-->
    <label for="email">Email: </label>
    <input type="email" id="email"/><br/>
    <!--  <input type="submit" value="Register"/>-->
    <button id="register-btn">Register</button>
</form>

<div id="error">

</div>

<script>
    const btn = document.querySelector("#register-btn");
    btn.addEventListener("click", async e => {
        e.preventDefault();

        const username = document.getElementById("username").value;
        const password = document.getElementById("password").value;
        const email = document.getElementById("email").value;

        const user = {
            "username": username,
            "password": password,
            "email": email
        };

        fetch("/register", {
            method: "POST",
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(user)
        })
        .then(response => response.json())
        .then(accountDto => {
            if (accountDto.message == null) {
                window.location = "/sign-in";
            } else {
                document.getElementById("error").innerHTML = accountDto.message;
            }
        });
    })
</script>
</body>
</html>